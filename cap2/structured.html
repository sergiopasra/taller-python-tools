
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arrays estructurados &#8212; Taller Python</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pandas" href="../cap3/intro.html" />
    <link rel="prev" title="Uso avanzado de índices" href="indexing.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Taller Python</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Taller de análisis de datos con Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Instalación
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../install.html">
   Taller de análisis de datos con Python
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python y Jupyter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/python.html">
   Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/sec2.html">
   Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/ide.html">
   Entornos de desarrollo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/jupyter.html">
   Anatomía de Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/Fibonacci.html">
   Números de Fibonnacci
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/magics.html">
   Comándos mágicos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/magicmd.html">
   Magic commands
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/cfibonacci.html">
   Números de Fibonnacci complejos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap1/jremote.html">
   Ejecución remota de cuadernos
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numpy
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datos.html">
   Tipos de datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="base0.html">
   Estructura básica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="base.html">
   Estructura de un
   <code class="docutils literal notranslate">
    <span class="pre">
     ndarray
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ufunc.html">
   Funciones universales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="broadcast.html">
   <em>
    Broadcasting
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mask.html">
   Comparaciones y máscaras booleanas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing.html">
   Uso avanzado de índices
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Arrays estructurados
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../cap3/intro.html">
   Pandas
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Matplotlib
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../cap4/intro.html">
   Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap4/linea.html">
   Gráficos de línea
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap4/disp.html">
   Gráficos de puntos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap4/disp.html#graficos-con-scatter">
   Gráficos con
   <code class="docutils literal notranslate">
    <span class="pre">
     scatter
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap4/error.html">
   Visualización de errores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cap4/estilos.html">
   Uso de estilos
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/cap2/structured.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/cap2/structured.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sergiopasra/taller-python-tools/main?urlpath=tree/ptools/cap2/structured.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodos-de-creacion-de-arrays-estructurados">
   Métodos de creación de arrays estructurados
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#el-tipo-recarray">
   El tipo
   <code class="docutils literal notranslate">
    <span class="pre">
     recarray
    </span>
   </code>
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="arrays-estructurados">
<h1>Arrays estructurados<a class="headerlink" href="#arrays-estructurados" title="Permalink to this headline">¶</a></h1>
<p>Una de las características que hemos visto de los arrays de numpy es que su tipo interno de datos es <strong>homogéneo</strong>.
Sin embargo, los datos tabulares a veces requieren datos con tipos heterogéneos.</p>
<p>Para este tipo de datos, numpy ofrece arrays con un tipo de datos complejo: arrays estructurados y <code class="docutils literal notranslate"><span class="pre">recarray</span></code>.</p>
<p>Este tipo de datos funcoina bien en escenarios de uso sencillos. Cuando las operaciones sobre los
datos se vuelven complejas, resulta más conveniente utilizar Pandas y su <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>Supongamos que tenemos datos sobre los planetas del sistema solar en diferentes categorías.
Se podrían almacenar estos datos en diferentes arrays o listas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">nombre</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mercurio&#39;</span><span class="p">,</span> <span class="s1">&#39;Venus&#39;</span><span class="p">,</span> <span class="s1">&#39;Tierra&#39;</span><span class="p">,</span> <span class="s1">&#39;Marte&#39;</span><span class="p">,</span> <span class="s1">&#39;Júpiter&#39;</span><span class="p">,</span> <span class="s1">&#39;Saturno&#39;</span><span class="p">,</span> <span class="s1">&#39;Urano&#39;</span><span class="p">,</span> <span class="s1">&#39;Neptuno&#39;</span><span class="p">]</span>
<span class="n">semieje</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">,</span> <span class="mf">9.54</span><span class="p">,</span> <span class="mf">19.19</span><span class="p">,</span> <span class="mf">30.06</span><span class="p">]</span>
<span class="n">nlunas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Pero este estilo no es muy conveniente. No hay nada en los datos que indique que pertencen a los
mismos objetos. Sería más natural si pudiéramos encuadrar los datos dentro de un única estrutura.</p>
<p>Numpy puede manejar este tipo de datos mediante arrays estructurados, que son que aqellos que tienen
un tipo de datos <code class="docutils literal notranslate"><span class="pre">dtype</span></code> compuesto.</p>
<p>Igual que para generar un array de enteros hacemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Podemos generar un array compuesto pasando un dicionario en <code class="docutils literal notranslate"><span class="pre">dtype</span></code> (hay otras posibilidades):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;semieje&#39;</span><span class="p">,</span> <span class="s1">&#39;nlunas&#39;</span><span class="p">),</span>
                          <span class="s1">&#39;formats&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;U10&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;u2&#39;</span><span class="p">)})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;nombre&#39;, &#39;&lt;U10&#39;), (&#39;semieje&#39;, &#39;&lt;f4&#39;), (&#39;nlunas&#39;, &#39;&lt;u2&#39;)]
</pre></div>
</div>
</div>
</div>
<p>Los diferentes formatos son</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">U10</span></code>: cadena de unicode longitud máxima 10</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f4</span></code>: número de coma flotante de 4 bytes o 32 bits</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u2</span></code>: número entero sin signo de 2 bytes o 16 bits</p></li>
</ul>
<p>Ahora que tenemos el contenedor creado, podemos rellenarlo con los valores anteriores.
Podemos acceder a cada columna por el nombre:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nombre</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;semieje&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">semieje</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;nlunas&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nlunas</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Mercurio&#39;,  0.39,  0) (&#39;Venus&#39;,  0.72,  0) (&#39;Tierra&#39;,  1.  ,  1)
 (&#39;Marte&#39;,  1.52,  2) (&#39;Júpiter&#39;,  5.2 , 79) (&#39;Saturno&#39;,  9.54, 82)
 (&#39;Urano&#39;, 19.19, 27) (&#39;Neptuno&#39;, 30.06, 14)]
</pre></div>
</div>
</div>
</div>
<p>De esta manera, todos los datos están almacendos en un solo objeto en memoria.
Además, podemos acceder a los registros por un índice o a las diferentes columnas
por nombre:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nombres de los planetas</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Mercurio&#39;, &#39;Venus&#39;, &#39;Tierra&#39;, &#39;Marte&#39;, &#39;Júpiter&#39;, &#39;Saturno&#39;,
       &#39;Urano&#39;, &#39;Neptuno&#39;], dtype=&#39;&lt;U10&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tercer planeta desde el Sol</span>
<span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;Tierra&#39;, 1., 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lunas del penúltimo planeta</span>
<span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;nlunas&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>27
</pre></div>
</div>
</div>
</div>
<p>Con las herramientas de las secciones anteriores podemos realizar filtrado
con máscara booleanas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lunas de los planetas exteriores</span>
<span class="c1"># i.e, distancia mayor que Marte (1.5)</span>
<span class="n">data</span><span class="p">[</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;semieje&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">][</span><span class="s1">&#39;nlunas&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([79, 82, 27, 14], dtype=uint16)
</pre></div>
</div>
</div>
</div>
<p>Aunque este tipo de manipulaciones son factibles, en cuanto se hacen un poco
complicadas es más práctico utilizar un paquete especializado de datos tabulares,
como pandas o xarray.</p>
<p>Los tipos estructurados de numpy están diseñados para reflejar los tipos de dato
<code class="docutils literal notranslate"><span class="pre">struct</span></code> de C y para acceder a <em>buffers</em> de datos de bajo nivel, como por
ejemplo para interpretar datos opacos (blobs) binarios. Por eso los <code class="docutils literal notranslate"><span class="pre">dtype</span></code>
estructurados tienen soporte para uniones (<code class="docutils literal notranslate"><span class="pre">union</span></code>), datos anidados, etc.
Puede darse el caso de que los tipos estructurados de numpy tengan peor desempeño
que los tipos de pandas.</p>
<div class="section" id="metodos-de-creacion-de-arrays-estructurados">
<h2>Métodos de creación de arrays estructurados<a class="headerlink" href="#metodos-de-creacion-de-arrays-estructurados" title="Permalink to this headline">¶</a></h2>
<p>Los arrays estructurados pueden crearse de diferentes maneras. Existen unas
cuantas que solo estan permitidas para mantener compatibilidad hacia atrás
con versiones antiguas de numpy (y que no deben utilizarse en código nuevo).</p>
<p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> puede especificarse como diccionario:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">({</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;semieje&#39;</span><span class="p">,</span> <span class="s1">&#39;nlunas&#39;</span><span class="p">),</span>
          <span class="s1">&#39;formats&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;U10&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">,</span> <span class="s1">&#39;u2&#39;</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype([(&#39;nombre&#39;, &#39;&lt;U10&#39;), (&#39;semieje&#39;, &#39;&lt;f4&#39;), (&#39;nlunas&#39;, &#39;&lt;u2&#39;)])
</pre></div>
</div>
</div>
</div>
<p>también con tipos de datos en vez de cadenas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">({</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span> <span class="s1">&#39;semieje&#39;</span><span class="p">,</span> <span class="s1">&#39;nlunas&#39;</span><span class="p">),</span>
          <span class="s1">&#39;formats&#39;</span><span class="p">:</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype([(&#39;nombre&#39;, &#39;&lt;U10&#39;), (&#39;semieje&#39;, &#39;&lt;f4&#39;), (&#39;nlunas&#39;, &#39;&lt;u2&#39;)])
</pre></div>
</div>
</div>
</div>
<p>o como lista de tuplas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">&#39;nombre&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span> <span class="p">(</span><span class="s1">&#39;semieje&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;nlunas&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype([(&#39;nombre&#39;, &#39;&lt;U10&#39;), (&#39;semieje&#39;, &#39;&lt;f4&#39;), (&#39;nlunas&#39;, &#39;&lt;u2&#39;)])
</pre></div>
</div>
</div>
</div>
<p>si no se da nombre a las columnas, el nombre por defecto es <code class="docutils literal notranslate"><span class="pre">f#</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;U10,f4,u2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dtype([(&#39;f0&#39;, &#39;&lt;U10&#39;), (&#39;f1&#39;, &#39;&lt;f4&#39;), (&#39;f2&#39;, &#39;&lt;u2&#39;)])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="el-tipo-recarray">
<h2>El tipo <code class="docutils literal notranslate"><span class="pre">recarray</span></code><a class="headerlink" href="#el-tipo-recarray" title="Permalink to this headline">¶</a></h2>
<p>Por último, mencionar que el tipo <code class="docutils literal notranslate"><span class="pre">recarray</span></code> es equivalente a los tipos estructurados
con la capacidad adicional de que se puede acceder a las columnas como <strong>atributo</strong>.</p>
<p>Podemos convertir la tabla anterior a recarray con</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_rec</span> <span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span>
<span class="n">data_rec</span><span class="o">.</span><span class="n">nlunas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  0,  1,  2, 79, 82, 27, 14], dtype=uint16)
</pre></div>
</div>
</div>
</div>
<p>La pega es que el acceso a los datos en un recarray es más lento</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> data[&#39;nlunas&#39;]
<span class="o">%</span><span class="k">timeit</span> data_rec[&#39;nlunas&#39;]
<span class="o">%</span><span class="k">timeit</span> data_rec.nlunas
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>172 ns ± 4.39 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.23 µs ± 130 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.46 µs ± 58.8 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Incluso usando el operador[], el acceso en recarray es más lento por un orden de magnitud</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "sergiopasra/taller-python-tools",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./cap2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="indexing.html" title="previous page">Uso avanzado de índices</a>
    <a class='right-next' id="next-link" href="../cap3/intro.html" title="next page">Pandas</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sergio Pascual<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>