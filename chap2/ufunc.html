
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Funciones universales &#8212; Taller Python</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Broadcasting" href="broadcast.html" />
    <link rel="prev" title="Tipos de datos" href="datos.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Taller Python</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Taller python tools
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python y Jupyter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../chap1/sec1.html">
   Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chap1/sec2.html">
   Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chap1/ide.html">
   Entornos de desarrollo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chap1/Fibonacci.html">
   Números de Fibonnacci
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chap1/magics.html">
   Comándos mágicos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../chap1/magicmd.html">
   Magic commands
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numpy
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="datos.html">
   Tipos de datos
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Funciones universales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="broadcast.html">
   <em>
    Broadcasting
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mask.html">
   Comparaciones y máscaras booleanas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing.html">
   Uso avanzado de índices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="structured.html">
   Arrays estructurados
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Matplotlib y plotly
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../part3.html">
   Matplotlib
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Pandas
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../part4.html">
   Pandas
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Uso de unidades
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../part5.html">
   Unidades
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/chap2/ufunc.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chap2/ufunc.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/sergiopasra/taller-python-tools/main?urlpath=tree/ptools/chap2/ufunc.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#la-velocidad-de-los-bucles">
   La velocidad de los bucles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ufuncs">
   Ufuncs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uso-avanzado">
   Uso avanzado
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#array-de-salida">
     Array de salida
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#agregacion">
     Agregación
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#producto-externo">
     Producto externo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#otros-metodos-de-ufunc">
     Otros métodos de ufunc
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="funciones-universales">
<h1>Funciones universales<a class="headerlink" href="#funciones-universales" title="Permalink to this headline">¶</a></h1>
<p>Hasta ahora hemos hablado de la necesidad de tener un tipo
de datos específico para arreglos numéricos, pero no hemos
especificado cómo utilizar numpy para acceder a operaciones
numéricas eficientes.</p>
<p>La clave para la eficiencia es utilizar operaciones vectorizadas,
las cuales numpy implementa mediante un mecanismo denominado
funciones universales, o <em>ufuncs</em>.</p>
<div class="section" id="la-velocidad-de-los-bucles">
<h2>La velocidad de los bucles<a class="headerlink" href="#la-velocidad-de-los-bucles" title="Permalink to this headline">¶</a></h2>
<p>Ya comentamos al hablar de los tipos de Python, que el carácter
dinámico del lenguaje hacer que incluso los tipos más básicos
se implementen con punteros a estructuras complejas (en la implementación
por defecto CPython, escrita en C).</p>
<p>La lentitud relativa de este acceso se manifiesta cuando se repiten
muchas operaciones numéricas sencillas, por ejemplo, cuando se
realizan muchas operaciones en un array grande de datos.</p>
<p>Veamos un ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">calcular_inv_cuad</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
        <span class="n">res</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">arr</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">calcular_inv_cuad</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.        , 0.01234568, 1.        , 0.25      , 0.02777778])
</pre></div>
</div>
</div>
</div>
<p>Este código es similar a lo que se haría, por ejemplo, en C.</p>
<p>Podemos utilizar el comando de celda <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> para medir
la velocidad de ejecución en un array más grande. Por ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> calcular_inv_cuad(val2)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.4 s ± 17 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
</div>
</div>
<p>En este caso, vemos que se tarda en promedio unos segundos
en realizar esta operación sencilla sobre un millón de enteros.
Pensando que esto no es más que una imagen de 1000x1000, parece
extremadamente lento.</p>
<p>Si analizáramos las llamadas internas en C, veríamos
que la mayor parte del tiempo se pierde en el acceso
a la estructura interna y comprobaciones de tipos.</p>
<p>En un lenguaje compilado, estas comprobaciones se antes
de la ejecución del código, durante la compilación, y
el resultado se calcularía de manera más eficiente.</p>
</div>
<div class="section" id="ufuncs">
<h2>Ufuncs<a class="headerlink" href="#ufuncs" title="Permalink to this headline">¶</a></h2>
<p>Para muchas operaciones numéricas, numpy ya proporciona
rutinas precompiladas para los diferentes tipos numéricos.
Esto es lo que se conoce como operación vectorizada.</p>
<p>Normalmente se accede a las operaciones vectorizas operando
directamente sobre los arrays en lugar de sus elementos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">calcular_inv_cuad</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">val</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.         0.01234568 1.         0.25       0.02777778]
[1.         0.01234568 1.         0.25       0.02777778]
</pre></div>
</div>
</div>
</div>
<p>Y la segunda operación se ejecuta órdenes de magnitud más raṕido:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> 1 / val**2
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.3 µs ± 7.91 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
</div>
</div>
<p>Internamente, numpy tiene construidas subrutinas para las diferentes
operaciones, tanto unarias como binarias. Cuando realizamos operaciones
entre arrays o entre arrays y números, numpy se encarga de llamar a
la rutina adecuada.</p>
<p>En general, numpy tiene versiones ufunc de todas las funciones matemáticas
en el módulo <code class="docutils literal notranslate"><span class="pre">math</span></code>, además de todos los operadores aritméticos.</p>
<p>Puede encontrarse la lista completa en la <a class="reference external" href="https://numpy.org/doc/stable/reference/ufuncs.html#available-ufuncs">documentación de numpy</a>.</p>
<p>En general, los operadores aritméticos pueden llamerse de dos maneras:
la obvia (+ para la suma, * para el producto) y mediante una función.
Por ejemplo, para sumar dos arrays, numpy llama a la función <code class="docutils literal notranslate"><span class="pre">np.add</span></code>.</p>
<p>De manera que <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code> es equivalente a <code class="docutils literal notranslate"><span class="pre">np.add(a,</span> <span class="pre">b),</span> <span class="pre">siempre</span> <span class="pre">que</span> </code>a<code class="docutils literal notranslate"><span class="pre">o</span></code>b` sean un array o un tipo numérico de Python.</p>
<p>A parte de las funciones en numpy, el paquete <code class="docutils literal notranslate"><span class="pre">scipy</span></code> también proporciona
funciones especiales como ufuncs en el módulo <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code>.</p>
<p>Por ejemplo, valores de la función de Bessel de primera especie y orden cero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.special</span>
<span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">j0</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.97762625 0.71962202 0.2930956 ]
</pre></div>
</div>
</div>
</div>
<p>Siempre conviene comprobar la definición exacta de la función que queremos
usar en la documentación de numpy o scipy, ya que pueden existir distintas
convenciones.</p>
</div>
<div class="section" id="uso-avanzado">
<h2>Uso avanzado<a class="headerlink" href="#uso-avanzado" title="Permalink to this headline">¶</a></h2>
<p>Los ufuncs de numpy tienen un interfaz uniforme y no solo son funciones,
también proporcionan métodos especializados.</p>
<div class="section" id="array-de-salida">
<h3>Array de salida<a class="headerlink" href="#array-de-salida" title="Permalink to this headline">¶</a></h3>
<p>Todos los ufunc tienen un argumento <code class="docutils literal notranslate"><span class="pre">out</span></code> que sirve para definir
el array de salida. Esto puede ser conveniente si se está trabajando con
arrays muy grandes, ya que esta operación ahorra la creación de un array
temporal y una copia.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-5.         -3.88888889 -2.77777778 -1.66666667 -0.55555556  0.55555556
  1.66666667  2.77777778  3.88888889  5.        ]
</pre></div>
</div>
</div>
</div>
<p>Mientras que la operación equivalente</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">*</span> <span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-5.         -3.88888889 -2.77777778 -1.66666667 -0.55555556  0.55555556
  1.66666667  2.77777778  3.88888889  5.        ]
</pre></div>
</div>
</div>
</div>
<p>crea un array temporal para contener el resultado de <code class="docutils literal notranslate"><span class="pre">arr</span> <span class="pre">*</span> <span class="pre">5</span></code>
y a continuación lo copia en <code class="docutils literal notranslate"><span class="pre">res</span></code>.</p>
<p>Para arrays pequeños la diferencia es insignificante, pero
el ahorro en memoria puede ser significativo para arrays grandes.</p>
</div>
<div class="section" id="agregacion">
<h3>Agregación<a class="headerlink" href="#agregacion" title="Permalink to this headline">¶</a></h3>
<p>Los ufuncs binarios proporcionan funciones de agregación que pueden ser de
utilidad en algunos casos. El método <code class="docutils literal notranslate"><span class="pre">reduce</span></code> convierte un array
en un número aplicando la función repetidamente sobre sus miembros, mientras
que el método <code class="docutils literal notranslate"><span class="pre">accumulate</span></code> guarda los resultados intermedios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>45
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  1,  3,  6, 10, 15, 21, 28, 36, 45])
</pre></div>
</div>
</div>
</div>
<p>Para el caso de la suma y el producto, ya existen funciones específicas
para reducción y acumulación: <code class="docutils literal notranslate"><span class="pre">np.sum</span></code>, <code class="docutils literal notranslate"><span class="pre">np.prod</span></code>, <code class="docutils literal notranslate"><span class="pre">np.cumsum</span></code>, <code class="docutils literal notranslate"><span class="pre">np.cumprod</span></code></p>
<p>Hay que tener cuidado y asegurarse de que el tipo del array es capaz
de contener los resultados de la acumulación. Sino es así hay que
añadir un argumento <code class="docutils literal notranslate"><span class="pre">dtype</span></code> para definir el tipo de salida.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint16&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[200 400]
[200 400]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="producto-externo">
<h3>Producto externo<a class="headerlink" href="#producto-externo" title="Permalink to this headline">¶</a></h3>
<p>Con un ufunc también se puede calcular una operación para todas las
posibles parejas de datos usando <code class="docutils literal notranslate"><span class="pre">outer</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.        , 0.        , 0.        ],
       [1.57079633, 0.46364761, 0.24497866],
       [1.57079633, 0.78539816, 0.46364761]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="otros-metodos-de-ufunc">
<h3>Otros métodos de ufunc<a class="headerlink" href="#otros-metodos-de-ufunc" title="Permalink to this headline">¶</a></h3>
<p>Los objetos ufunc tiene otros atributos y métodos como <code class="docutils literal notranslate"><span class="pre">reduceat</span></code> y <code class="docutils literal notranslate"><span class="pre">at</span></code>.
Además, la función ufunc puede tener otros argumentos además de <code class="docutils literal notranslate"><span class="pre">out</span></code>,
como por ejemplo <code class="docutils literal notranslate"><span class="pre">where</span></code>, <code class="docutils literal notranslate"><span class="pre">axis</span></code>, <code class="docutils literal notranslate"><span class="pre">order</span></code> o <code class="docutils literal notranslate"><span class="pre">keepdims</span></code>.
El soporte de cada argumento depende de la versión de numpy y es
conveniente comprobar la <a class="reference external" href="https://numpy.org/doc/stable/reference/ufuncs.html#overriding-ufunc-behavior">documentación</a>.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chap2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="datos.html" title="previous page">Tipos de datos</a>
    <a class='right-next' id="next-link" href="broadcast.html" title="next page"><em>Broadcasting</em></a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sergio Pascual<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>